VENV := qgsw/.venv
BIN = ${VENV}/bin/
PIP = ${BIN}/pip3
ENVIRONMENT_FILE := qgsw/environment.yml
REQUIREMENTS := qgsw/requirements.txt

clear-qgsw:
	rm qgsw.zip
	rm -rf qgsw

unzip-qgsw:
	mkdir qgsw
	unzip qgsw.zip -d qgsw

copy-dotenv-qgsw:
	@cp .env qgsw/.env

load-conda:
	module load conda

${VENV}:
	conda env create --file ${ENVIRONMENT_FILE} --prefix ${VENV}

install: ${VENV}
	@${PIP} install -e ./qgsw

set-qgsw:
	@${MAKE} unzip-qgsw
	@${MAKE} copy-dotenv-qgsw
	@${MAKE} install
	rm qgsw.zip